<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
<!-------------------------------------------------BOOTSTRAP CDN ------------------------------------------------>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
    integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz"
    crossorigin="anonymous"></script>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">

<!-- ----------------------------------------------------ICON ----------------------------------------------------->
    <script type="module" src="https://unpkg.com/ionicons@7.1.0/dist/ionicons/ionicons.esm.js"></script>
    <script nomodule src="https://unpkg.com/ionicons@7.1.0/dist/ionicons/ionicons.js"></script>
    
    
</head>
<body>

<!-------------------------------------------------------CSS STYLE  ------------------------------------------------>
    <style>
        .btn-edit ion-icon,
        .btn-delete ion-icon{
                 pointer-events: none;
                }

    </style>


<!-------------------------------------------------------TABLE LIST --------------------------------------------->

    <h1 class="text-center">Resume Builder</h1>
    <table class="table table-striped w-50">
        <thead>
            <tr>
                <th>S.no</th>
                <th>Name</th>
                <th>Email</th>
                <th>Edit</th>
                <th>Delete</th>
            </tr>
        </thead>
        <tbody id="tBody">
           
        </tbody>
    </table>

    <!-----------------------------------------------------FireBase -------------------------------------------------------- -->
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.0.2/firebase-app.js";
        import { getDatabase, ref, onValue, set, get, child,remove} from "https://www.gstatic.com/firebasejs/11.0.2/firebase-database.js";
        
        // const appSetting = {
        //     databaseURL : "https://resume-project-b1255-default-rtdb.firebaseio.com/",
        // };

        // Your web app's Firebase configuration
        const firebaseConfig = {
            apiKey: "AIzaSyCixAsqF-OnKJfhlMB-2OMBWxyVL5mYZaU",
            authDomain: "resume-project-b1255.firebaseapp.com",
            projectId: "resume-project-b1255",
            storageBucket: "resume-project-b1255.firebasestorage.app",
            messagingSenderId: "310749836829",
            appId: "1:310749836829:web:e830f1650d6cc746f7f8f4"
        };

        // Initialize Firebase
        const app = initializeApp(firebaseConfig);

        //   get ref to database services

        const db = getDatabase(app);

        const initialDbdata = ref(db,'user/');

        function display(){
            onValue(initialDbdata, function (snapshot){
                const data = snapshot.val();
                let userArray =Object.entries(data);
                let trs = "";
                let index = 1;  
                for(let each of userArray){

                    console.log(each)
                   trs = trs + `
                     <tr>
                        <td>${index}</td>
                        <td>${each[1].fullname}</td>
                        <td>${each[1].email}</td>
                        <td><button class="btn-edit" onclick = "edit()">
                                    <ion-icon name="create-outline"></ion-icon>
                            </button>
                        </td>
                         <td>
                            <button class="btn-delete" onclick = "Delete('${each[0]}')">
                                <ion-icon name="trash-outline" ></ion-icon>
                            </button>
                        </td>
                     </tr>
                   `
                   index++
                }
                document.getElementById("tBody").innerHTML = trs
                
            })
           
        }

        window.displayresume = display
        display()

        function Delete(id){
            let data =  ref(db,`user/${id}`);
            remove(data);
        }
        
        window.Delete = Delete
        Delete()

    
    </script>
    
</body>
</html>